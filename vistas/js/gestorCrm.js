/*=============================================
TABLA PROSPECTOS
=============================================*/

tablaProspectos = $(".tablaProspectos").DataTable({
   "ajax":"ajax/tablaProspectos.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});

/*=============================================
TABLA OPORTUNIDADES
=============================================*/

tablaOportunidades = $(".tablaOportunidades").DataTable({
   "ajax":"ajax/tablaOportunidades.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});

/*=============================================
TABLA CLIENTES
=============================================*/

tablaClientes = $(".tablaClientes").DataTable({
   "ajax":"ajax/tablaClientes.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});

/*=============================================
TABLA VENTAS
=============================================*/

tablaVentas = $(".tablaVentas").DataTable({
   "ajax":"ajax/tablaVentasPorPeriodo.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});

/*=============================================
TABLA PENDIENTES
=============================================*/

tablaPendientes = $(".tablaPendientes").DataTable({
   "ajax":"ajax/tablaPendientes.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/*=============================================
TABLA EVENTOS
=============================================*/

tablaEventos = $(".tablaEventos").DataTable({
   "ajax":"ajax/tablaEventos.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/**
 * MOSTRAR TABLAS DE EVENTOS DEPENDIENDO
 * DEL TIPO DE SELECCION EN EL MENU
 * SE CARGA LA TABLA QUE ES LLAMADA EN EL 
 * MENU
 *
 * 
 */

String.prototype.capitalize = function(){
  return this.charAt(0).toUpperCase() + this.slice(1);
}

var tabla = localStorage.getItem("eventos");

if (tabla == "llamadas") {

    var tablaOrigen = "llamada";

}else{

    var tablaOrigen = tabla;
}
 $("#"+tabla).DataTable({
   "ajax":"ajax/tablaEventosCalendario.ajax.php?tabla="+tablaOrigen,
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/*
OBTENER DETALLES DEL EVENTO
 */
$("#"+tabla).on("click",".btnDetalleEvento",function(){

      var idEvento = $(this).attr("idEvento");
      var tablaEvento = $(this).attr("tabla");
      
      var datos = new FormData();
      datos.append('idEvento',idEvento);
      datos.append('tablaEvento',tablaEvento);

      $.ajax({
        url: "ajax/functions.ajax.php",
        method: "POST",
        data: datos,
        cache: false,
        contentType: false,
        processData: false,
        success: function(respuesta) {

              var resp = JSON.parse(respuesta);
              $("#detalle"+tabla.capitalize()).modal('show');
              
              if (tabla == "citas" || tabla == "demostraciones") {

                if (tabla == "citas") {
                  $("#detalleUbicacion").val(resp[0]["ubicacion"]);
                  $("#detalleLatitud").val(resp[0]["latitud"]);
                  $("#detalleLongitud").val(resp[0]["longitud"]);
                  $("#detalleInvitados").val(resp[0]["invitados"]);

                  initMap(resp[0]["latitud"],resp[0]["longitud"]);

            
                }else if (tabla == "demostraciones"){

                  $("#detalleUbicacion").val(resp[0]["ubicacion"]);
                  $("#detalleLatitud").val(resp[0]["latitud"]);
                  $("#detalleLongitud").val(resp[0]["longitud"]);


                  initMap(resp[0]["latitud"],resp[0]["longitud"]);

                  var listaCabeceras = ['Producto'];

                  body = document.getElementById("tablaDetalleProductosDemostracion");

                  thead = document.createElement("thead");
                  thead.setAttribute('style','background:#008B8B;color: white');

                  theadTr = document.createElement("tr");

                  for (var h = 0; h < listaCabeceras.length; h++) {
                      
                      var celdaThead = document.createElement("th");
                      var textoCeldaThead = document.createTextNode(listaCabeceras[h]);
                      celdaThead.appendChild(textoCeldaThead);
                      theadTr.appendChild(celdaThead);

                  }
                
                  thead.appendChild(theadTr);
       
                  tblBody = document.createElement("tbody");

                  var  productos = resp[0]["productos"];
                  var  productos = productos.split(',');

                  
                  // Crea las celdas
                  for (var i = 0; i <  productos.length; i++) {
                    // Crea las hileras de la tabla
                    var hilera = document.createElement("tr");
                 
                        var celda = document.createElement("td");
                        var textoCelda = document.createTextNode(productos[i]);
                        celda.appendChild(textoCelda);
                        hilera.appendChild(celda);
                       
                 
                    // agrega la hilera al final de la tabla (al final del elemento tblbody)
                    tblBody.appendChild(hilera);
                  }
                 
                  // appends <table> into <body>
                  body.appendChild(tblBody);
                  body.appendChild(thead);
                        

                }
                  
              }else{

                  $("#detalleUbicacion").val(resp[0]["ubicacion"]);
                  $("#detalleLatitud").val(resp[0]["latitud"]);
                  $("#detalleLongitud").val(resp[0]["longitud"]);

                  initMap(resp[0]["latitud"],resp[0]["longitud"]);

              }
             
             
            }
        });


});
function initMap(latitud,longitud) {
    var locationRio = {lat: 19.011903, lng: -98.205545};
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 13,
      center: locationRio,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      icon : image
    });


    var image = {
      url: 'vistas/img/plantilla/paint.png', //ruta de la imagen
      size: new google.maps.Size(40, 60), //tamaño de la imagen
      origin: new google.maps.Point(0,0), //origen de la iamgen
      //el ancla de la imagen, el punto donde esta marcando, en nuestro caso el centro inferior.
      anchor: new google.maps.Point(20, 60)
    };

    var directionsService = new google.maps.DirectionsService;
    var directionsRenderer = new google.maps.DirectionsRenderer({
      draggable: true,
      map: map,
      panel: document.getElementById('right-panel')
    });

    directionsRenderer.addListener('directions_changed', function() {
      computeTotalDistance(directionsRenderer.getDirections());


    });
    var latitudProspecto = latitud;
    var longitudProspecto = longitud;
    var direccionesProspecto = ''+latitudProspecto+','+longitudProspecto+'';

    var latitudAgente = 19.011903;
    var longitudAgente =-98.205545;
    var coordenadaAgente = ''+latitudAgente+','+longitudAgente+'';

    displayRoute(''+coordenadaAgente+'', ''+direccionesProspecto+'', directionsService,
    directionsRenderer);

  }

  function displayRoute(origin, destination, service, display) {
    document.getElementById('right-panel').innerHTML="";
    service.route({
      origin: origin,
      destination: destination,

      travelMode: 'DRIVING',
      avoidTolls: true
    }, function(response, status) {
      if (status === 'OK') {
        display.setDirections(response);
      } else {
        console.log('Could not display directions due to: ' + status);
      }
    });
  }

  function computeTotalDistance(result) {
    var total = 0;
    var myroute = result.routes[0];
    for (var i = 0; i < myroute.legs.length; i++) {
      total += myroute.legs[i].distance.value;
    }
    total = total / 1000;
    document.getElementById('total').innerHTML = total + ' km';
  }
$(".btnCerrarVistaEventos").on("click", function() {
        //localStorage.removeItem("latitudProspecto");
        //localStorage.removeItem("longitudProspecto");
        
        
});

/**
 * OBTENER EL DETALLE DE LA FINALIZACION DEL EVENTO DE QUE TRATO EL EVENTO
 */
$("#"+tabla).on("click",".btnDetalleFinalizado",function(){

      var idEvento = $(this).attr("idEvento");
      var tablaEvento = $(this).attr("tabla");
      
      var datos = new FormData();
      datos.append('idEventoFinalizado',idEvento);
      datos.append('tablaEventoFinalizado',tablaEvento);


       $.ajax({
        url: "ajax/functions.ajax.php",
        method: "POST",
        data: datos,
        cache: false,
        contentType: false,
        processData: false,
        success: function(respuesta) {

              var resp = JSON.parse(respuesta);
              $("#informacion"+tabla.capitalize()).modal('show');

              $("#detalleFinalizacion").val(resp["detalle"]);
              
             
             
            }
        });


});
/*=============================================
TABLA DESCARTADOS
=============================================*/

tablaDescartados = $(".tablaDescartados").DataTable({
   "ajax":"ajax/tablaDescartados.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/*=============================================
TABLA BITACORA
=============================================*/

tablaBitacora = $(".tablaBitacora").DataTable({
   "ajax":"ajax/tablaBitacora.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/*=============================================
TABLA BITACORA
=============================================*/

tablaHistorial = $(".tablaHistorial").DataTable({
   "ajax":"ajax/tablaHistorialSeguimientos.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});
/*=============================================
TABLA DIRECTORIO
=============================================*/

tablaDirectorio = $(".tablaDirectorio").DataTable({
   "ajax":"ajax/tablaDirectorio.ajax.php",
   "deferRender": true,
   "retrieve": true,
   "processing": true,
   "language": {

    "sProcessing":     "Procesando...",
    "sLengthMenu":     "Mostrar _MENU_ registros",
    "sZeroRecords":    "No se encontraron resultados",
    "sEmptyTable":     "Ningún dato disponible en esta tabla",
    "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_",
    "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0",
    "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
    "sInfoPostFix":    "",
    "sSearch":         "Buscar:",
    "sUrl":            "",
    "sInfoThousands":  ",",
    "sLoadingRecords": "Cargando...",
    "oPaginate": {
      "sFirst":    "Primero",
      "sLast":     "Último",
      "sNext":     "Siguiente",
      "sPrevious": "Anterior"
    },
    "oAria": {
        "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
    }

   }

});


/*
MOSTRAR LA LISTA DE PRODUCTOS EN OPORTUNIDADES Y VENTAS
 */


$(".tablaOportunidades").on("click",".btnVisualizarProductos",function(){

    var idOportunidad = $(this).attr("idOportunidad");
    var tablaOportunidad = "oportunidades";
    
    var datos = new FormData();
    datos.append('idOportunidad',idOportunidad);
    datos.append('tablaOportunidad',tablaOportunidad);
    $.ajax({

    url:"ajax/functions.ajax.php",
    method: "POST",
    data: datos,
    cache: false,
    contentType: false,
    processData: false,
    dataType: "json",
    success: function(respuesta){ 

            
            var montoTotal = respuesta["monto"];
      
            var monto = document.getElementById("montoTotalOportunidad");
            monto.innerHTML = '$'+' '+montoTotal;

            monto.setAttribute("style", "font-size:19px;font-weight:bold;color:#008B8B");
            
        
            var listaCabeceras = ['Codigo','Descripcion','Cantidad','Precio'];

            body = document.getElementById("tablaDetalleProductos");

            thead = document.createElement("thead");
            thead.setAttribute('style','background:#008B8B;color: white');

            theadTr = document.createElement("tr");

            for (var h = 0; h < listaCabeceras.length; h++) {
                
                var celdaThead = document.createElement("th");
                var textoCeldaThead = document.createTextNode(listaCabeceras[h]);
                celdaThead.appendChild(textoCeldaThead);
                theadTr.appendChild(celdaThead);

            }
          
            thead.appendChild(theadTr);
 
            tblBody = document.createElement("tbody");

            var  codigos = respuesta["codigos"];
            var  codigos = codigos.split(',');

            var  productos = respuesta["productos"];
            var  productos = productos.split(',');

            var  cantidades = respuesta["cantidades"];
            var  cantidades = cantidades.split(',');

            var  precios = respuesta["precios"];
            var  precios = precios.split(',');
            // Crea las celdas
            for (var i = 0; i <  codigos.length; i++) {
              // Crea las hileras de la tabla
              var hilera = document.createElement("tr");
           
                  var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(codigos[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                  var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(productos[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                   var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(cantidades[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                  var celda = document.createElement("td");
                  var precio = precios[i]*1;
                  var textoCelda = document.createTextNode("$ "+precio.toFixed(2));
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
           
              // agrega la hilera al final de la tabla (al final del elemento tblbody)
              tblBody.appendChild(hilera);
            }
           
            // appends <table> into <body>
            body.appendChild(tblBody);
            body.appendChild(thead);
          
        }



  })



});
$(".tablaVentas").on("click",".btnVisualizarProductos",function(){

    var idOportunidad = $(this).attr("idOportunidad");
    var tablaOportunidad = "oportunidades";
    
    var datos = new FormData();
    datos.append('idOportunidad',idOportunidad);
    datos.append('tablaOportunidad',tablaOportunidad);
    $.ajax({

    url:"ajax/functions.ajax.php",
    method: "POST",
    data: datos,
    cache: false,
    contentType: false,
    processData: false,
    dataType: "json",
    success: function(respuesta){ 

            
            var montoTotal = respuesta["monto"];
      
            var monto = document.getElementById("montoTotalOportunidad");
            monto.innerHTML = '$'+' '+montoTotal;

            monto.setAttribute("style", "font-size:19px;font-weight:bold;color:#008B8B");
            
        
            var listaCabeceras = ['Codigo','Descripcion','Cantidad','Precio'];

            body = document.getElementById("tablaDetalleProductos");

            thead = document.createElement("thead");
            thead.setAttribute('style','background:#008B8B;color: white');

            theadTr = document.createElement("tr");

            for (var h = 0; h < listaCabeceras.length; h++) {
                
                var celdaThead = document.createElement("th");
                var textoCeldaThead = document.createTextNode(listaCabeceras[h]);
                celdaThead.appendChild(textoCeldaThead);
                theadTr.appendChild(celdaThead);

            }
          
            thead.appendChild(theadTr);
 
            tblBody = document.createElement("tbody");

            var  codigos = respuesta["codigos"];
            var  codigos = codigos.split(',');

            var  productos = respuesta["productos"];
            var  productos = productos.split(',');

            var  cantidades = respuesta["cantidades"];
            var  cantidades = cantidades.split(',');

            var  precios = respuesta["precios"];
            var  precios = precios.split(',');
            // Crea las celdas
            for (var i = 0; i <  codigos.length; i++) {
              // Crea las hileras de la tabla
              var hilera = document.createElement("tr");
           
                  var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(codigos[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                  var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(productos[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                   var celda = document.createElement("td");
                  var textoCelda = document.createTextNode(cantidades[i]);
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
                  var celda = document.createElement("td");
                  var precio = precios[i]*1;
                  var textoCelda = document.createTextNode("$ "+precio.toFixed(2));
                  celda.appendChild(textoCelda);
                  hilera.appendChild(celda);
           
              // agrega la hilera al final de la tabla (al final del elemento tblbody)
              tblBody.appendChild(hilera);
            }
           
            // appends <table> into <body>
            body.appendChild(tblBody);
            body.appendChild(thead);
          
        }



  })



});
$(".btnCerrarVista").on("click", function() {

        var nodos = document.getElementById('tablaDetalleProductos');
        while (nodos.firstChild) {
          nodos.removeChild(nodos.firstChild);
        }
});
/*
BUSCAR EL TIMELINE DEL USUARIO INDICADO
 */
$("#buscarTimeline").change(function() {
    
    var id = document.getElementById("buscarTimeline").value;

    var datos = new FormData();
    datos.append('idProspectoTimeline',id);

     $.ajax({

    url:"ajax/functions.ajax.php",
    method: "POST",
    data: datos,
    cache: false,
    contentType: false,
    processData: false,
    dataType: "json",
    success: function(respuesta){ 
        
       
        
         var json = respuesta;
         

         $("#timelineSection").html(""); 
         for (var i = 0; i < json.length; i++) {
           if (i % 2 == 0) {
              var clase = "left";
           }else{
              var clase = "right";
           }
           var acum = i+1;

           var fecha = json[i]["fecha"];

           var año = fecha.substring(0,4);
           var mes = fecha.substring(5,7);
           var dia = fecha.substring(8,10);;

           const date = new Date(año, mes-1, dia); 
           const month = date.toLocaleString('es-MX', { month: 'long' });

           var seguimiento = `<div class="timeline-article">
                                            <div class="content-`+clase+`-container">
                                              <div class="content-`+clase+`">
                                                <p>`+json[i]["titulo"]+`<span class="article-number">`+acum+`</span></p>
                                              </div>
                                              <span class="timeline-author">`+json[i]["fecha"]+`</span>
                                            </div>
                                            
                                            <div class="meta-date">
                                              <span class="date">`+mes+`</span>
                                              <span class="month">`+month+`</span>
                                            </div>
                                          </div>
                                         
                                         `;
                                      $("#timelineSection").append(seguimiento);
         }
          
       
          
          
    }



  })


});

/*=============================================
HABILITAR PROSPECTO A AGENTE
=============================================*/
$(".tablaProspectos").on("click", ".btnHabilitarProspecto", function(){

  var idProspecto = $(this).attr("idProspecto");
  var estadoProspecto= $(this).attr("estadoProspecto");

  var datos = new FormData();
    datos.append("idProspectoHabilitado", idProspecto);
    datos.append("estadoProspecto", estadoProspecto);

    $.ajax({

    url:"ajax/functions.ajax.php",
    method: "POST",
    data: datos,
    cache: false,
      contentType: false,
      processData: false,
      success: function(respuesta){
        console.log("respuesta", respuesta);
      }

    })

    if(estadoProspecto== 0){

      $(this).removeClass('btn-success');
      $(this).addClass('btn-danger');
      $(this).html('<i class="fa fa-power-off"></i>Deshabilitado');
      $(this).attr('estadoProspecto',1);

    }else{

      $(this).addClass('btn-success');
      $(this).removeClass('btn-danger');
      $(this).html('<i class="fa fa-power-off"></i>Habilitado');
      $(this).attr('estadoProspecto',0);

    }

})
